{"ast":null,"code":"import axios from 'axios';\nimport { CALC_AMOUNT, CALC_CALCULATE_FROM, CALC_CALCULATE_TO, EXCHANGE_CALCULATE_FROM, GET_SUMMARY, HIDE_ALERT, HIDE_LOADER, RATES_FETCH, SHOW_ALERT, SHOW_LOADER, UPDATE_FROM_TO } from \"./types\";\nconst options = {\n  method: 'GET',\n  url: 'https://exchangerate-api.p.rapidapi.com/rapid/latest/USD',\n  headers: {\n    'X-RapidAPI-Host': 'exchangerate-api.p.rapidapi.com',\n    'X-RapidAPI-Key': '17ae393c6emshdd9cf9a325f83dbp1faa29jsnded4f4454e45'\n  }\n}; // Запрос к API\n\nexport function ratesFetch() {\n  return dispatch => {\n    dispatch({\n      type: SHOW_LOADER\n    });\n    axios.request(options).then(function (response) {\n      const currencies = ['USD', 'EUR', 'RUB', 'BYN', 'INR', 'CNY', 'TRY', 'GBP', 'CHF', 'JPY', 'THB']; // Шаблон с нужными (используемыми) валютами\n\n      const date = new Date(); // Здесь и на строчке ниже получаем дату последнего обновления\n\n      const lastUpdate = date.getDate() + '.' + (date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1) + '.' + date.getFullYear();\n      const fetchedCurrensies = currencies.map(currency => Object.entries(response.data.rates).filter(item => item[0] === currency)); // получаем массив с нужными валютами\n\n      for (let i = 0; i < fetchedCurrensies.length; i++) {\n        // убираем лишнюю вложенность\n        let temp = fetchedCurrensies[i][0];\n        fetchedCurrensies[i] = temp;\n      }\n\n      dispatch({\n        type: RATES_FETCH,\n        fetchedData: response.data,\n        lastUpdate,\n        currencies: fetchedCurrensies\n      }); // передаём массив с нужными валютами в соответствующие редьюсеры\n\n      const fromRate = Object.entries(response.data.rates).filter(currency => currency[0] === 'USD')[0][1];\n      const toRate = Object.entries(response.data.rates).filter(currency => currency[0] === 'RUB')[0][1];\n      dispatch({\n        type: UPDATE_FROM_TO,\n        from: 'USD',\n        to: 'RUB',\n        fromRate,\n        toRate,\n        currencies: fetchedCurrensies\n      });\n      setTimeout(() => {\n        dispatch({\n          type: HIDE_LOADER\n        });\n      }, 500);\n    }).catch(function (error) {\n      console.error(error);\n    });\n  };\n}\nexport function calculatorFrom(value, rate) {\n  return {\n    type: CALC_CALCULATE_FROM,\n    currency: value,\n    rate\n  };\n}\nexport function calculatorTo(value, rate) {\n  return {\n    type: CALC_CALCULATE_TO,\n    currency: value,\n    rate\n  };\n}\nexport function exchangeFrom(value) {\n  return {\n    type: EXCHANGE_CALCULATE_FROM,\n    currency: value\n  };\n}\nexport function calculatorAmount(value) {\n  return {\n    type: CALC_AMOUNT,\n    amount: value\n  };\n}\nexport function wrongInput() {\n  return dispatch => {\n    dispatch({\n      type: SHOW_ALERT\n    });\n    setTimeout(() => {\n      dispatch({\n        type: HIDE_ALERT\n      });\n    }, 1500);\n  };\n}\nexport function summary() {\n  return {\n    type: GET_SUMMARY\n  };\n}","map":{"version":3,"names":["axios","CALC_AMOUNT","CALC_CALCULATE_FROM","CALC_CALCULATE_TO","EXCHANGE_CALCULATE_FROM","GET_SUMMARY","HIDE_ALERT","HIDE_LOADER","RATES_FETCH","SHOW_ALERT","SHOW_LOADER","UPDATE_FROM_TO","options","method","url","headers","ratesFetch","dispatch","type","request","then","response","currencies","date","Date","lastUpdate","getDate","getMonth","getFullYear","fetchedCurrensies","map","currency","Object","entries","data","rates","filter","item","i","length","temp","fetchedData","fromRate","toRate","from","to","setTimeout","catch","error","console","calculatorFrom","value","rate","calculatorTo","exchangeFrom","calculatorAmount","amount","wrongInput","summary"],"sources":["/home/teplospb/Документы/Web-Dev/test-task-2/src/components/redux/actions.js"],"sourcesContent":["import axios from 'axios';\nimport { CALC_AMOUNT, CALC_CALCULATE_FROM, CALC_CALCULATE_TO, EXCHANGE_CALCULATE_FROM, GET_SUMMARY, HIDE_ALERT, HIDE_LOADER, RATES_FETCH, SHOW_ALERT, SHOW_LOADER, UPDATE_FROM_TO } from \"./types\";\n\nconst options = {\n  method: 'GET',\n  url: 'https://exchangerate-api.p.rapidapi.com/rapid/latest/USD',\n  headers: {\n    'X-RapidAPI-Host': 'exchangerate-api.p.rapidapi.com',\n    'X-RapidAPI-Key': '17ae393c6emshdd9cf9a325f83dbp1faa29jsnded4f4454e45'\n  }\n};\n\n// Запрос к API\nexport function ratesFetch() {\n    return dispatch => {\n        dispatch({ type: SHOW_LOADER })\n        axios.request(options).then(function (response) {\n            const currencies = ['USD','EUR','RUB','BYN','INR','CNY','TRY','GBP','CHF','JPY','THB']; // Шаблон с нужными (используемыми) валютами\n            const date = new Date(); // Здесь и на строчке ниже получаем дату последнего обновления\n            const lastUpdate = date.getDate() + '.' + (((date.getMonth() + 1) < 10) ? '0' + (date.getMonth() + 1) : (date.getMonth() + 1)) + '.' + date.getFullYear();\n            const fetchedCurrensies = currencies.map(currency => Object.entries(response.data.rates).filter(item => item[0]=== currency)); // получаем массив с нужными валютами\n            for(let i = 0; i < fetchedCurrensies.length; i++) { // убираем лишнюю вложенность\n              let temp = fetchedCurrensies[i][0];\n              fetchedCurrensies[i] = temp;\n            }\n            dispatch({ type: RATES_FETCH, fetchedData: response.data, lastUpdate, currencies: fetchedCurrensies }); // передаём массив с нужными валютами в соответствующие редьюсеры\n            const fromRate = Object.entries(response.data.rates).filter(currency => currency[0] === 'USD')[0][1];\n            const toRate = Object.entries(response.data.rates).filter(currency => currency[0] === 'RUB')[0][1];\n            dispatch({ type: UPDATE_FROM_TO, from: 'USD', to: 'RUB', fromRate, toRate, currencies: fetchedCurrensies })\n            setTimeout(() => {\n              dispatch({type: HIDE_LOADER });\n            }, 500)\n        }).catch(function (error) {\n            console.error(error);\n        });\n    }\n}\n\nexport function calculatorFrom(value, rate) {\n  return {\n    type: CALC_CALCULATE_FROM,\n    currency: value,\n    rate\n  }\n}\n\nexport function calculatorTo(value, rate) {\n  return {\n    type: CALC_CALCULATE_TO,\n    currency: value,\n    rate\n  }\n}\n\nexport function exchangeFrom(value) {\n  return {\n    type: EXCHANGE_CALCULATE_FROM,\n    currency: value\n  }\n}\n\nexport function calculatorAmount(value) {\n  return {\n    type: CALC_AMOUNT,\n    amount: value\n  }\n}\n\nexport function wrongInput() {\n  return dispatch => {\n    dispatch({ type: SHOW_ALERT });\n    setTimeout(() => {\n      dispatch({ type: HIDE_ALERT })\n    }, 1500)\n  }\n}\n\nexport function summary() {\n  return {\n    type: GET_SUMMARY,\n  }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}